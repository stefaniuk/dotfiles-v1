#!/bin/bash

# ### Mac OS X #################################################################

function macosx-install-packer {

    $brew_install \
        packer
}

# ### Ubuntu ###################################################################

function ubuntu-install-packer {

    ver=$(www_get https://www.packer.io/downloads.html | grep '_linux_amd64.zip' | egrep '/[0-9]+\.[0-9]+\.[0-9]+' | egrep -o '[0-9]+\.[0-9]+\.[0-9]+' | sortvr | head -n 1)
    file_download \
        --url "https://releases.hashicorp.com/packer/$ver/packer_${ver}_linux_amd64.zip" \
        --file "packer_${ver}_linux_amd64.zip"
    sudo unzip -o packer_${ver}_linux_amd64.zip -d /usr/local/bin
    rm packer_${ver}_linux_amd64.zip
}

# ### common ###################################################################

function config-packer {

    # completion
    local dir
    [ -f /etc/bash_completion ] && dir=/etc/bash_completion.d || dir=/usr/local/etc/bash_completion.d
    sudo wget \
        "https://raw.githubusercontent.com/Bash-it/bash-it/master/completion/available/packer.completion.bash" \
        -O $dir/packer-completion.bash
}
